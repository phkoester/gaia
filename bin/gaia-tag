#!/usr/bin/env bash
#
# gaia-tag
#
# Usage: gaia-tag [PROJECT [VERSION]]
#
# Tag a project with a version, or list existing tags.
#

source "$GAIA_DIR/src/main/bash/gaia/init" || exit 2

set -e

eval $(cl-get-options "" "$@")
project=
[[ $1 ]] && eval $(cl-get-args PROJECT)
version=
[[ $1 ]] && eval $(cl-get-args VERSION)

if [[ $project ]]; then
  project_dir="$HOME/project"
  dir="$project_dir/$project"
  [[ ! -d $dir ]] && shell-error -e2 Project \'$project\' does not exist
  cd "$dir"

  if [[ $version ]]; then
    git tag -a "v$version" -m "Version $version"
    git push origin --tags
  fi
fi

git tag -n9 # List existing tags

# EOF
